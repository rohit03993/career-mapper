# Deployment Guide - careermapper.in on Hostinger VPS

## Prerequisites
- Hostinger VPS with CloudPanel installed
- Domain `careermapper.in` pointed to your VPS IP
- SSH access to the server
- Git repository access

## Step 1: Add Domain in CloudPanel

1. Log into CloudPanel at `https://YOUR_IP:8443`
2. Go to **Sites** → **Add Site**
3. Enter domain: `careermapper.in`
4. Select PHP version: **8.2** or **8.3**
5. Click **Add Site**

This will create:
- Site user: `careermapper` (or similar)
- Directory: `/home/careermapper/htdocs/`

## Step 2: SSH into Server and Navigate

```bash
ssh root@YOUR_SERVER_IP
# OR
ssh careermapper@YOUR_SERVER_IP

cd /home/careermapper/htdocs
```

## Step 3: Clone Repository

```bash
# Remove default files if any
rm -rf *

# Clone your repository
git clone https://github.com/rohit03993/career-mapper.git .

# OR if using SSH
git clone git@github.com:rohit03993/career-mapper.git .
```

## Step 4: Install Dependencies

```bash
# Install Composer dependencies
composer install --no-dev --optimize-autoloader

# Install NPM dependencies (if needed)
npm install
npm run build
```

## Step 5: Setup Environment File

```bash
# Copy .env.example to .env
cp .env.example .env

# Generate application key
php artisan key:generate
```

Edit `.env` file:
```env
APP_NAME="Career Mapper"
APP_ENV=production
APP_KEY=base64:... (generated by key:generate)
APP_DEBUG=false
APP_URL=https://careermapper.in

DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=careermapper_db
DB_USERNAME=careermapper_user
DB_PASSWORD=your_secure_password

MAIL_MAILER=smtp
MAIL_HOST=smtp.hostinger.com
MAIL_PORT=587
MAIL_USERNAME=noreply@careermapper.in
MAIL_PASSWORD=your_email_password
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@careermapper.in
MAIL_FROM_NAME="Career Mapper"
```

## Step 6: Create Database

In CloudPanel:
1. Go to **Sites** → **careermapper.in** → **Databases**
2. Click **Add Database**
3. Create database: `careermapper_db`
4. Create user: `careermapper_user`
5. Set a strong password
6. Grant all privileges

## Step 7: Run Migrations and Seeders

```bash
php artisan migrate --force
php artisan db:seed --force
```

## Step 8: Setup Storage and Permissions

```bash
# Create storage symlink
php artisan storage:link

# Fix permissions
chmod -R 775 storage
chmod -R 775 bootstrap/cache
chown -R careermapper:www-data storage
chown -R careermapper:www-data bootstrap/cache
chown -R careermapper:careermapper .
```

## Step 9: Configure Web Server

### Update Document Root in CloudPanel:
1. Go to **Sites** → **careermapper.in** → **Vhost**
2. Set **Document Root** to: `/home/careermapper/htdocs/public`
3. Save changes

### Or manually edit vhost (if needed):
```bash
# The vhost should point to: /home/careermapper/htdocs/public
```

## Step 10: Setup SSL Certificate

In CloudPanel:
1. Go to **Sites** → **careermapper.in** → **SSL/TLS**
2. Click **Let's Encrypt**
3. Select domain: `careermapper.in`
4. Click **Issue Certificate**

## Step 11: Clear Caches

```bash
php artisan config:cache
php artisan route:cache
php artisan view:cache
php artisan optimize
```

## Step 12: Verify Deployment

1. Visit: `https://careermapper.in`
2. Check admin panel: `https://careermapper.in/admin`
3. Test image uploads
4. Verify all pages load correctly

## Step 13: Setup Cron Jobs (Optional)

In CloudPanel:
1. Go to **Sites** → **careermapper.in** → **Cron Jobs**
2. Add cron job:
   ```
   * * * * * cd /home/careermapper/htdocs && php artisan schedule:run >> /dev/null 2>&1
   ```

## Troubleshooting

### Images not showing:
```bash
php artisan storage:link
chmod -R 775 storage
chown -R careermapper:www-data storage
```

### Permission denied errors:
```bash
chown -R careermapper:www-data storage bootstrap/cache
chmod -R 775 storage bootstrap/cache
```

### 500 errors:
```bash
# Check logs
tail -f storage/logs/laravel.log

# Clear caches
php artisan optimize:clear
php artisan config:clear
```

### Database connection errors:
- Verify database credentials in `.env`
- Check database user has proper permissions
- Ensure database exists in CloudPanel

## Quick Deployment Script

Save this as `deploy.sh` and run it:

```bash
#!/bin/bash
cd /home/careermapper/htdocs
git pull origin main
composer install --no-dev --optimize-autoloader
php artisan migrate --force
php artisan storage:link
php artisan config:cache
php artisan route:cache
php artisan view:cache
php artisan optimize
chmod -R 775 storage bootstrap/cache
chown -R careermapper:www-data storage bootstrap/cache
echo "Deployment complete!"
```

